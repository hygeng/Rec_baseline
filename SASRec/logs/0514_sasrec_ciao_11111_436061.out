/cluster/home/it_stu110/.conda/envs/my/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:523: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/cluster/home/it_stu110/.conda/envs/my/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:524: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/cluster/home/it_stu110/.conda/envs/my/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/cluster/home/it_stu110/.conda/envs/my/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/cluster/home/it_stu110/.conda/envs/my/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/cluster/home/it_stu110/.conda/envs/my/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:532: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
batch_size,32
dataset,ciao
dropout_rate,0.2
hidden_units,50
l2_emb,0.0
lr,0.001
maxlen,200
num_blocks,2
num_epochs,201
num_heads,1
train_dir,logs/
average sequence length: 18.25
load data: 0.3860781192779541
2020-05-14 09:17:33.870966: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-14 09:17:36.993231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
pciBusID: 0000:b9:00.0
totalMemory: 10.92GiB freeMemory: 610.50MiB
2020-05-14 09:17:36.993729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-05-14 09:17:47.999401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-14 09:17:48.000024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-05-14 09:17:48.000513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-05-14 09:17:48.001299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 321 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:b9:00.0, compute capability: 6.1)
WARNING:tensorflow:From /cluster/home/it_stu110/.conda/envs/my/lib/python3.6/site-packages/tensorflow/python/util/tf_should_use.py:189: initialize_all_variables (from tensorflow.python.ops.variables) is deprecated and will be removed after 2017-03-02.
Instructions for updating:
Use `tf.global_variables_initializer` instead.
2020-05-14 09:18:19.398539: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.02GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2020-05-14 09:18:19.496910: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.02GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2020-05-14 09:18:19.499168: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.58GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2020-05-14 09:19:26.637297: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.26GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
..........Evaluating ..............
epoch:10, time: 86.776569(s), valid (NDCG@10: 0.031162, HR@10: 0.054318, Recall@10: 0.006890), test (NDCG@10: 0.030561, HR@10: 0.058932, Recall@10: 0.006980)
(0.031161655310058326, 0.054317732366512855, 0.006890314265283694) (0.030560504540898047, 0.05893210283454186, 0.00697974103195463)

..........Evaluating ..............
epoch:20, time: 152.304024(s), valid (NDCG@10: 0.031129, HR@10: 0.054713, Recall@10: 0.006676), test (NDCG@10: 0.025325, HR@10: 0.050494, Recall@10: 0.006479)
(0.031128582214484113, 0.05471324983520105, 0.0066763974622279345) (0.025325489921076343, 0.05049439683586025, 0.0064788442189220915)

..........Evaluating ..............
epoch:30, time: 217.939090(s), valid (NDCG@10: 0.028758, HR@10: 0.051417, Recall@10: 0.006383), test (NDCG@10: 0.023224, HR@10: 0.045880, Recall@10: 0.005844)
(0.02875774908197126, 0.051417270929466054, 0.006382724360579873) (0.02322400082312383, 0.04588002636783125, 0.005844447251491629)

..........Evaluating ..............
epoch:40, time: 283.829880(s), valid (NDCG@10: 0.027280, HR@10: 0.049572, Recall@10: 0.005939), test (NDCG@10: 0.022131, HR@10: 0.043507, Recall@10: 0.005624)
(0.027280400386271508, 0.04957152274225445, 0.005938922099423832) (0.022130601866144985, 0.043506921555702044, 0.005624119922887183)

..........Evaluating ..............
epoch:50, time: 349.472709(s), valid (NDCG@10: 0.025259, HR@10: 0.046012, Recall@10: 0.005450), test (NDCG@10: 0.020717, HR@10: 0.041661, Recall@10: 0.005267)
(0.02525852294690694, 0.04601186552406065, 0.0054497200868910845) (0.020717484636713097, 0.04166117336849044, 0.0052673249875330175)

..........Evaluating ..............
epoch:60, time: 415.608932(s), valid (NDCG@10: 0.024814, HR@10: 0.044166, Recall@10: 0.005435), test (NDCG@10: 0.017904, HR@10: 0.035333, Recall@10: 0.004608)
(0.024813989509429795, 0.044166117336849046, 0.005434996545978349) (0.017904067660969223, 0.035332893869479236, 0.0046083202806311225)

..........Evaluating ..............
epoch:70, time: 475.796255(s), valid (NDCG@10: 0.027968, HR@10: 0.049044, Recall@10: 0.006074), test (NDCG@10: 0.021900, HR@10: 0.043902, Recall@10: 0.005678)
(0.02796826225187965, 0.04904416611733685, 0.006074125906573253) (0.02190006770558277, 0.04390243902439024, 0.005678422805024733)

..........Evaluating ..............
epoch:80, time: 535.947125(s), valid (NDCG@10: 0.025673, HR@10: 0.046539, Recall@10: 0.005560), test (NDCG@10: 0.019913, HR@10: 0.041002, Recall@10: 0.005268)
(0.025673434188202192, 0.046539222148978245, 0.00555984032220652) (0.019913409412701377, 0.04100197758734344, 0.005268086159386528)

..........Evaluating ..............
epoch:90, time: 596.282959(s), valid (NDCG@10: 0.024553, HR@10: 0.044166, Recall@10: 0.005339), test (NDCG@10: 0.019646, HR@10: 0.041397, Recall@10: 0.005158)
(0.02455266219337863, 0.044166117336849046, 0.005338540104113425) (0.01964617638321234, 0.041397495056031644, 0.0051584327421563166)

..........Evaluating ..............
epoch:100, time: 656.171647(s), valid (NDCG@10: 0.023329, HR@10: 0.042189, Recall@10: 0.005057), test (NDCG@10: 0.020529, HR@10: 0.042584, Recall@10: 0.005479)
(0.02332881864562108, 0.04218852999340804, 0.005056887512857549) (0.02052877661061195, 0.04258404746209624, 0.005479172979972918)

..........Evaluating ..............
epoch:110, time: 716.225433(s), valid (NDCG@10: 0.025770, HR@10: 0.045748, Recall@10: 0.005365), test (NDCG@10: 0.021611, HR@10: 0.044693, Recall@10: 0.005444)
(0.025770470535614622, 0.04574818721160184, 0.005365030911249375) (0.02161135580232601, 0.04469347396176664, 0.005443583202437004)

..........Evaluating ..............
epoch:120, time: 776.272867(s), valid (NDCG@10: 0.024191, HR@10: 0.043507, Recall@10: 0.005360), test (NDCG@10: 0.018976, HR@10: 0.037970, Recall@10: 0.004512)
(0.02419071121448769, 0.043506921555702044, 0.005359781552846867) (0.01897567628639161, 0.03796967699406724, 0.004512488916040091)

..........Evaluating ..............
epoch:130, time: 836.800023(s), valid (NDCG@10: 0.025589, HR@10: 0.044825, Recall@10: 0.005524), test (NDCG@10: 0.019867, HR@10: 0.040870, Recall@10: 0.005288)
(0.02558854067240159, 0.04482531311799604, 0.005524443939853308) (0.019867311380383727, 0.04087013843111404, 0.005288464270124824)

..........Evaluating ..............
epoch:140, time: 898.180251(s), valid (NDCG@10: 0.025929, HR@10: 0.047198, Recall@10: 0.005884), test (NDCG@10: 0.020079, HR@10: 0.041529, Recall@10: 0.005302)
(0.02592883528785877, 0.04719841793012525, 0.005883738897188277) (0.020078836792957737, 0.04152933421226104, 0.0053016277484348)

..........Evaluating ..............
epoch:150, time: 959.512205(s), valid (NDCG@10: 0.022086, HR@10: 0.041002, Recall@10: 0.004540), test (NDCG@10: 0.019301, HR@10: 0.039024, Recall@10: 0.005072)
(0.0220858528982812, 0.04100197758734344, 0.0045401161850873485) (0.019301292450247597, 0.03902439024390244, 0.005071916435281728)

..........Evaluating ..............
epoch:160, time: 1021.062737(s), valid (NDCG@10: 0.022933, HR@10: 0.043639, Recall@10: 0.005352), test (NDCG@10: 0.018199, HR@10: 0.037179, Recall@10: 0.004805)
(0.022933228477619458, 0.04363876071193144, 0.005352027093402753) (0.01819862702393175, 0.03717864205669084, 0.004804866065991807)

..........Evaluating ..............
epoch:170, time: 1082.540877(s), valid (NDCG@10: 0.023566, HR@10: 0.042320, Recall@10: 0.004919), test (NDCG@10: 0.017503, HR@10: 0.036124, Recall@10: 0.004431)
(0.023565987062192796, 0.042320369149637445, 0.004918984235956615) (0.017503172221633303, 0.03612392880685564, 0.004431324260651374)

..........Evaluating ..............
epoch:180, time: 1144.041340(s), valid (NDCG@10: 0.022524, HR@10: 0.041793, Recall@10: 0.005350), test (NDCG@10: 0.018336, HR@10: 0.038233, Recall@10: 0.004855)
(0.02252422751782543, 0.04179301252471984, 0.005350305319848148) (0.018335977933681136, 0.03823335530652604, 0.0048549118246536075)

..........Evaluating ..............
epoch:190, time: 1205.330504(s), valid (NDCG@10: 0.022126, HR@10: 0.039420, Recall@10: 0.004533), test (NDCG@10: 0.017573, HR@10: 0.037310, Recall@10: 0.004681)
(0.022125740564316966, 0.039419907712590636, 0.004532820093319596) (0.017573481496086694, 0.037310481212920237, 0.0046805135847850805)

..........Evaluating ..............
epoch:200, time: 1266.735693(s), valid (NDCG@10: 0.020742, HR@10: 0.040343, Recall@10: 0.004838), test (NDCG@10: 0.015768, HR@10: 0.032828, Recall@10: 0.004100)
(0.020741864997787574, 0.04034278180619644, 0.004838433581568737) (0.015767785064777197, 0.03282794990112063, 0.004099995808243905)

.Done
